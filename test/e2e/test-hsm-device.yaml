apiVersion: v1
kind: Secret
metadata:
  name: test-hsm-pin
  namespace: hsm-secrets-operator-system
type: Opaque
data:
  pin: dGVzdDEyMzQ= # base64 encoded "test1234"
---
apiVersion: hsm.j5t.io/v1alpha1
kind: HSMDevice
metadata:
  name: test-pico-hsm
  namespace: hsm-secrets-operator-system
  labels:
    device-type: pico-hsm
    environment: test
  annotations:
    hsm.j5t.io/test-mode: "true"
spec:
  deviceType: PicoHSM
  discovery:
    # Use auto-discovery for test environment
    autoDiscovery: true
    usb:
      vendorId: "20a0"
      productId: "4230"
  pkcs11:
    # No libraryPath specified - will use mock client in test mode
    slotId: 0
    pinSecret:
      name: "test-hsm-pin"
      key: "pin"
    tokenLabel: "TestPicoHSM"
  maxDevices: 1
---
apiVersion: hsm.j5t.io/v1alpha1
kind: HSMSecret
metadata:
  name: test-secret
  namespace: hsm-secrets-operator-system
  labels:
    environment: test
spec:
  autoSync: true
  syncInterval: 30